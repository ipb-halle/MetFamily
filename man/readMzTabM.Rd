% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/readMzTabM.R
\name{readMzTabM}
\alias{readMzTabM}
\title{Convert mzTab-M file to QFeatures object}
\usage{
readMzTabM(file, load_sml = TRUE)
}
\arguments{
\item{file}{character(1) Path to the mzTab-M file.}

\item{load_sml}{logical(1) Include SML section and link to SMF. Default TRUE.}
}
\value{
QFeatures object with SMF (and optionally SML) assays.
Column names use sample labels when unique, otherwise assay labels or IDs.
Metadata from MTD section is automatically merged into colData.
}
\description{
Parses an mzTab-M file and converts it to a QFeatures object with
automatic metadata enrichment and linking between sections.
}
\details{
\strong{Requirements}: mzTab-M file with MTD assay entries, SMF section containing
\code{SMF_ID} and \code{abundance_assay[n]} columns. Optional: sample, ms_run,
and study_variable metadata for enriched colData.

\strong{Column Name Standardization}: The function automatically maps mzTab-M
column names to MetFamily's expected format:
\itemize{
\item colData: \code{study_variable_label} -> \code{Class} (for PCA/HCA grouping),
\code{Type} = "Sample"
\item rowData: \code{SMF_ID} -> \code{Alignment ID},
\code{exp_mass_to_charge} -> \code{Average Mz},
\code{retention_time_in_seconds} -> \code{Average Rt(min)}
(converted from seconds to minutes),
\code{chemical_name} -> \code{Metabolite name},
\code{adduct_ion} -> \code{Adduct ion name},
\code{inchi_key} -> \code{INCHIKEY},
\code{smiles} -> \code{SMILES}
}
Optional columns that are never used in analysis (Fill \%, Dot product,
Fragment presence \%, etc.) are not created. Missing columns are set to NA.

\strong{Linking}: SML rows are linked to SMF via \code{SMF_ID_REFS} using either
AssayLinks (1:1) or Hits objects (many-to-many).

\strong{Error handling}: Strict validation with helpful errors for duplicate IDs,
missing required sections, and invalid references.
}
\examples{
\dontrun{
# Basic conversion with comprehensive metadata enrichment
qf <- readMzTabM("path/to/file.mzTab")

# SMF only (no SML section)
qf_smf_only <- readMzTabM("path/to/file.mzTab", load_sml = FALSE)

# Access enriched metadata
colData(qf)
colData(qf[["SMF"]])

# Access raw MTD section metadata
S4Vectors::metadata(qf)$mzTabM$mtd_raw

# Column names will be sample labels when available and unique,
# otherwise assay labels, or finally assay IDs as fallback
colnames(qf[["SMF"]])
}

}
